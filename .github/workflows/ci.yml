# Archivo: .github/workflows/ci.yml
# VersiÃ³n corregida para usar el runner self-hosted

name: IntegraciÃ³n Continua (CI)

on:
  push:
    branches-ignore:
      - 'main'
  pull_request:
    branches:
      - 'main'

jobs:
  tests-y-build:
    # La correcciÃ³n clave: le asignamos el job a nuestro runner.
    runs-on: self-hosted

    steps:
    - name: ğŸ“¥ Clonar el cÃ³digo
      uses: actions/checkout@v4

    - name: ğŸ Simular tests para 'vote' (Python)
      run: echo "âœ… Tests de Python para 'vote' pasaron."

    - name: ğŸ“¦ Simular tests para 'result' (Node.js)
      run: echo "âœ… Tests de Node.js para 'result' pasaron."

    - name: ğŸ§  Simular tests para 'worker' (Node.js)
      run: echo "âœ… Tests de Node.js para 'worker' pasaron."

    - name: ğŸ³ Construir imÃ¡genes Docker con Docker Compose
      # Este paso ahora funcionarÃ¡ porque nuestro runner SÃ tiene 'docker-compose'
      working-directory: ./roxs-voting-app # AsegÃºrate que la ruta sea correcta
      run: docker-compose build
